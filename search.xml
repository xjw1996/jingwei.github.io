<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="2021/01/20/docker-mysql/"/>
      <url>2021/01/20/docker-mysql/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token property">title</span><span class="token punctuation">:</span> 在Docker里面部署MySQL<span class="token property">date</span><span class="token punctuation">:</span> 2020-03-15 19<span class="token punctuation">:</span>00<span class="token punctuation">:</span>41<span class="token property">tags</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><p>docker centos 安装教程<a href="https://docs.docker.com/engine/install/centos/">官方链接</a></p><ol><li>卸载可能存在的之前版本</li></ol><pre class="line-numbers language-none"><code class="language-none">$ sudo yum remove docker \                  docker-client \                  docker-client-latest \                  docker-common \                  docker-latest \                  docker-latest-logrotate \                  docker-logrotate \                  docker-engine<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>安装依赖</li></ol><pre class="line-numbers language-none"><code class="language-none">$ sudo yum install -y yum-utils$ sudo yum-config-manager \    --add-repo \    https://download.docker.com/linux/centos/docker-ce.repo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>安装docker engine</li></ol><p><code>$ sudo yum install docker-ce docker-ce-cli containerd.io</code></p><ol start="4"><li>重启docker</li></ol><p><code>sudo systemctl start docker</code></p><ol start="5"><li>查看docker版本</li></ol><p><code>docker -v</code></p><ol start="6"><li>查看docker镜像</li></ol><p><code>docker images</code></p><ol start="7"><li>设置开机自动启动docker</li></ol><p><code>sudo systemctl enable docker</code></p><h1 id="docker-hub"><a href="#docker-hub" class="headerlink" title="docker hub"></a>docker hub</h1><ul><li><p>下载MySQL镜像</p><p><code>sudo docker pull mysql:5.7</code></p></li><li><p>检查下载好的镜像</p><p><code>sudo docker images</code></p></li><li><p>切换root的用户</p><p><code>su root</code></p></li><li><p>启动容器</p><p>docker run -p 3306:3306 –name mysql \</p><pre class="line-numbers language-docker" data-language="docker"><div class="caption"><span>run -p 3306:3306 --name mysql \</span></div><code class="language-docker">  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>-v /mydata/mysql/log:/var/log/mysql <br>-v /mydata/mysql/data:/var/lib/mysql <br>-v /mydata/mysql/conf:/etc/mysql <br>-e MYSQL_ROOT_PASSWORD=root <br>-d mysql:5.7</p></blockquote><pre class="line-numbers language-none"><code class="language-none">  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​    -p 3306:3306为端口映射</p></li></ul><p>-v 是目录挂载 具体意思是在本体linux下的/mydata/mysql/log  ：冒号就是与容器内部的/var/log/mysql进行挂载，直白的说容器内部log文件的记录 会直接反应到linux指定目录下，容器内不的日志，linux在外面也能够看到</p><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206042715896.png" alt="image-20201206042715896"></p><p>如上图所示，MySQL容器挂载的各个log，数据，配置文件dg在外面root linux里面也是可以访问到的，容器外部对挂载文件直接修改，是可以同步到容器</p><ul><li><p>查看docker运行中的容器</p><p><code>docker ps</code></p></li><li><p>进入MySQL容器内部</p><ul><li><code>docker exec -it docker容器的前三位id\或者容器的名字 /bin/bash</code></li></ul><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206041010738.png" alt="image-20201206041010738"></p><ul><li>就会发现我们进入容器内部的环境当中，因为每一个容器都是一个小型的linux系统，如上图为哦们已经进入到MySQL容器的内部</li></ul><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206041301662.png" alt="image-20201206041301662"></p><ul><li>查看目录结构会发现，他就是一个完整的一个linux的目录结构</li></ul><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206041123447.png" alt="image-20201206041123447"></p></li><li><p>查看MySQL装在了那个位置</p><p><code>whereis mysql</code></p><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206041528226.png" alt="image-20201206041528226"></p></li></ul><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206041628752.png" alt="image-20201206041628752"></p><p>访问linux的3306接口也就能够访问到MySQL容器的3306的端口</p><p>cd conf      vi my.cnf</p><ul><li>复制下面配置文件</li></ul><p>[client]</p><p>default-character-set=utf8</p><p>[mysql]</p><p>default-character-set=utf8</p><p>[mysqld]</p><p>init_connect=’SET collation_connection = utf8_unicode_ci’</p><p>init_connect=’SET NAMES utf8’</p><p>character-set-server=utf8</p><p>collation-server=utf8_unicode_ci</p><p>skip-character-set-client-handshake</p><p>skip-name-resolve</p><p><img src="C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20210103002604957.png" alt="image-20210103002604957"></p><ul><li><p>docker 重启mysql</p><p><code>docker restart mysql</code></p></li></ul><ul><li><p>进入交互模式</p><p><code>docker exec -it mysql /bin/bash</code></p><p>查看linux上配置的文件是否同步到位</p></li></ul>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
