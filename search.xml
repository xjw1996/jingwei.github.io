<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>基于renren-fast开发，负载均衡缺少pom文件大坑</title>
      <link href="2021/01/06/renren-fast/"/>
      <url>2021/01/06/renren-fast/</url>
      
        <content type="html"><![CDATA[<p>@通过网关连接renren-fast时候报的错</p><h1 id="Error-creating-bean-with-name-‘ribbonLoadBalancingHttpClient’"><a href="#Error-creating-bean-with-name-‘ribbonLoadBalancingHttpClient’" class="headerlink" title="Error creating bean with name ‘ribbonLoadBalancingHttpClient’"></a>Error creating bean with name ‘ribbonLoadBalancingHttpClient’</h1><p>通过spring gateway 网关把请求分配给renren-fast的时候出现了以下错误。</p><pre class="line-numbers language-none"><code class="language-none">2021-01-06 22:47:02.793 ERROR 14024 --- [ctor-http-nio-2] a.w.r.e.AbstractErrorWebExceptionHandler : [b41c453c] 500 Server Error for HTTP GET "/api/captcha.jpg?uuid=197cc4fb-3695-43cd-8293-8cf4dc31b91f"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>couse by 1</p><pre class="line-numbers language-none"><code class="language-none">Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'ribbonLoadBalancer' defined in org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration: Unsatisfied dependency expressed through method 'ribbonLoadBalancer' parameter 2; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'ribbonServerListFilter' defined in org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.netflix.loadbalancer.ServerListFilter]: Factory method 'ribbonServerListFilter' threw exception; nested exception is java.lang.NoClassDefFoundError: com/netflix/servo/monitor/Monitors<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>couse by 2</p><pre class="line-numbers language-none"><code class="language-none">Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'ribbonServerListFilter' defined in org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.netflix.loadbalancer.ServerListFilter]: Factory method 'ribbonServerListFilter' threw exception; nested exception is java.lang.NoClassDefFoundError: com/netflix/servo/monitor/Monitors<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210106222317765.png" alt="在这里插入图片描述">根本没有这个东西</p><p>所以参考<br>链接: <a href="https://www.cnblogs.com/ye-feng-yu/p/11106006.html">link</a>.的博客gateway ribbon 负载均衡这块，发现自己的pom文件里没有如下依赖</p><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;    &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;    &lt;version&gt;2.1.0.RELEASE&lt;/version&gt;&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个加上，重新reload Maven 重跑gateway<br><img src="https://img-blog.csdnimg.cn/2021010700364017.png" alt="在这里插入图片描述"><br>原先获取图片的地方由500 变成了 200  成功了 </p>]]></content>
      
      
      <categories>
          
          <category> renren-fast </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu安装 NVIDIA Driver，CUDA, cuDNN</title>
      <link href="2020/04/06/ubuntu-an-zhuang/"/>
      <url>2020/04/06/ubuntu-an-zhuang/</url>
      
        <content type="html"><![CDATA[<ul><li>用USB引导盘装好系统以后，选英语语言和英语键盘并且加入字体库命令</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> /usr/lib/locale$ <span class="token function">sudo</span> locale-gen - -purge - -no-archive<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol><li>下载 NVIDIA  Driver</li></ol><table><thead><tr><th>CUDA Toolkit</th><th>Linux x86_64 Driver Version</th></tr></thead><tbody><tr><td>CUDA 9.2(9.2.88)</td><td>&gt;=396.26</td></tr><tr><td>CUDA 9.2(9.2.148 Update 1)</td><td>&gt;=396.37 &amp;&amp; &lt;410.48</td></tr><tr><td>CUDA 10.1</td><td>&gt;=418.39</td></tr><tr><td>CUDA 10.2.89</td><td>&gt;=440.33</td></tr><tr><td>CUDA 11.0.1 RC</td><td>&gt;=450.36.06</td></tr><tr><td>CUDA 11.0.2 GA</td><td>&gt;=450.51.05</td></tr><tr><td>CUDA 11.0.3 Update 1</td><td>&gt;=450.51.06</td></tr></tbody></table><ol start="2"><li>NVIDIA  Driver 安装</li></ol><p>在google搜索nvidia drivers找到官网，下载驱动</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> purge nvidia*$ <span class="token function">sudo</span> <span class="token function">apt-get</span> autoremove$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential gcc-multilib dkms$ <span class="token function">sudo</span> <span class="token function">touch</span> /etc/modprobe.d/blacklist-nouveau.conf$ <span class="token function">sudo</span> gedit /etc/modprobe.d/blacklist-nouveau.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输入<br>blacklist nouveau<br>options nouveau modeset=0<br>进入/etc/default 找到grub文件，在此⻚打开terminal，输入命令</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> gedit grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在 GRUB-CMDLINE-LINUX-DEFAULT=“quiet splash“处的splash 后加nomodeset</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> update-initramfs -u $ <span class="token function">sudo</span> update-grub2$ <span class="token builtin class-name">cd</span> ~$ <span class="token builtin class-name">cd</span> /Downloads$ <span class="token function">ls</span> -la$ <span class="token function">sudo</span> <span class="token function">chmod</span> +x NVIDIA-Linux-x86_64-450.57.run $ <span class="token function">sudo</span> ./NVIDIA-Linux-x86_64-450.57.run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>安装CUDA</li></ol><p>去官网找到相应版本，installer Type选deb(local)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">nano</span> /etc/profile.d/cuda.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>输入</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/usr/local/cuda/bin<span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDADIR</span><span class="token operator">=</span>/usr/local/cuda<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">chmod</span> +x /etc/profile.d/cuda.sh $ <span class="token function">sudo</span> <span class="token function">nano</span> /etc/ld.so.conf.d/cuda.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输入</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/usr/local/cuda/lib64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> ldconfig $ <span class="token function">reboot</span>$ nvcc - -version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="4"><li>cuDNN 的安装<br>官方网站下载cudnn</li></ol><ul><li>cuDNN Library for Linux (x86)</li><li>cuDNN Runtime Library for Ubuntu 18.04</li><li>cuDNN Developer Library for Ubuntu 18.04</li><li>cuDNN Code Samples and User Guide for Ubuntu 18.04</li><li>如果双击后在软件仓库安装时出现无法俺从来而情况，可以通过命令安装</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> dpkg -i 要解压的文件<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.1 将文件解压并复制到CUDA中</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">tar</span> -xzvf cudnn-ooxx.tgz //解压文件，也可手动解压$ <span class="token function">sudo</span> <span class="token function">cp</span> cuda/include/cudnn.h /usr/local/cuda/include$ <span class="token function">sudo</span> <span class="token function">cp</span> cuda/lib64/libcudnn* /usr/local/cuda/lib64$ <span class="token function">sudo</span> <span class="token function">chmod</span> a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>4.2 检验cuDNN是否安装成功</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cp</span> -r /usr/src/cudnn_samples_v7/mnistCUDNN <span class="token environment constant">$HOME</span>$ <span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>/cudnn_samples_v7/mnistCUDNN $ <span class="token function">make</span> clean <span class="token operator">&amp;&amp;</span> <span class="token function">make</span>$ ./mnistCUDNN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>出现了Test passed！ 则安装成功</p><p>如果命令copy过去没有编译成功 可以手动复制过去</p><p><img src="https://img-blog.csdnimg.cn/20210120045448638.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI0MzQ4Ng==,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210120045501656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI0MzQ4Ng==,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> Ubuntu </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Docker里面导入MySQL</title>
      <link href="2019/12/06/docker-mysql/"/>
      <url>2019/12/06/docker-mysql/</url>
      
        <content type="html"><![CDATA[<h1 id="docker-hub"><a href="#docker-hub" class="headerlink" title="docker hub"></a>docker hub</h1><ul><li><p>下载MySQL镜像</p><p><code>sudo docker pull mysql:5.7</code></p></li><li><p>检查下载好的镜像</p><p><code>sudo docker images</code></p></li><li><p>切换root的用户</p><p><code>su root</code></p></li><li><p>启动容器</p><p>docker run -p 3306:3306 –name mysql \</p></li></ul><blockquote><p>-v /mydata/mysql/log:/var/log/mysql <br>-v /mydata/mysql/data:/var/lib/mysql <br>-v /mydata/mysql/conf:/etc/mysql <br>-e MYSQL_ROOT_PASSWORD=root <br>-d mysql:5.7</p></blockquote><pre><code>-p 3306:3306为端口映射</code></pre><p>-v 是目录挂载 具体意思是在本体linux下的/mydata/mysql/log  ：冒号就是与容器内部的/var/log/mysql进行挂载，直白的说容器内部log文件的记录 会直接反应到linux指定目录下，容器内不的日志，linux在外面也能够看到</p><p><img src="https://img-blog.csdnimg.cn/20210120010836980.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI0MzQ4Ng==,size_16,color_FFFFFF,t_70"></p><p>如上图所示，MySQL容器挂载的各个log，数据，配置文件dg在外面root linux里面也是可以访问到的，容器外部对挂载文件直接修改，是可以同步到容器</p><ul><li><p>查看docker运行中的容器</p><p><code>docker ps</code></p></li><li><p>进入MySQL容器内部</p><ul><li><code>docker exec -it docker容器的前三位id\或者容器的名字 /bin/bash</code></li></ul><p><img src="https://img-blog.csdnimg.cn/2021012001085931.png"></p><ul><li>就会发现我们进入容器内部的环境当中，因为每一个容器都是一个小型的linux系统，如上图为哦们已经进入到MySQL容器的内部</li></ul><p><img src="https://img-blog.csdnimg.cn/20210120010917607.png"></p></li></ul><ul><li>查看目录结构会发现，他就是一个完整的一个linux的目录结构</li></ul><p><img src="https://img-blog.csdnimg.cn/20210120011025911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI0MzQ4Ng==,size_16,color_FFFFFF,t_70"></p><ul><li><p>查看MySQL装在了那个位置</p><p><code>whereis mysql</code><br><img src="https://img-blog.csdnimg.cn/20210120011051134.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-uuUv48u2-1611076069706)(C:\Users\jinue\AppData\Roaming\Typora\typora-user-images\image-20201206041528226.png)]"></p></li><li><p>下图是docker容器文件挂载与端口映射<br><img src="https://img-blog.csdnimg.cn/20210120011126996.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI0MzQ4Ng==,size_16,color_FFFFFF,t_70"></p></li></ul><p>访问linux的3306接口也就能够访问到MySQL容器的3306的端口</p><p>cd conf      vi my.cnf</p><ul><li>复制下面配置文件</li></ul><p>[client]</p><p>default-character-set=utf8</p><p>[mysql]</p><p>default-character-set=utf8</p><p>[mysqld]</p><p>init_connect=’SET collation_connection = utf8_unicode_ci’</p><p>init_connect=’SET NAMES utf8’</p><p>character-set-server=utf8</p><p>collation-server=utf8_unicode_ci</p><p>skip-character-set-client-handshake</p><p>skip-name-resolve</p><p><img src="https://img-blog.csdnimg.cn/20210120011245615.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTI0MzQ4Ng==,size_16,color_FFFFFF,t_70"></p><ul><li><p>docker 重启mysql</p><p><code>docker restart mysql</code></p></li></ul><ul><li><p>进入交互模式</p><p><code>docker exec -it mysql /bin/bash</code></p><p>查看linux上配置的文件是否同步到位</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
